# BDD Gherkin Сценарии для OrderResource

Этот каталог содержит BDD (Behavior-Driven Development) сценарии на русском языке для функциональности управления заказами в системе Cashbox.

## Структура файлов

### 1. `order_creation.feature` - Создание заказов
Описывает функциональность создания новых заказов, включая:
- Простое создание заказа
- Создание заказа с выбором тарифа
- Применение скидок и авансов
- Создание новых клиентов и услуг при создании заказа
- Валидация обязательных полей
- Автоматический расчет сумм
- Права доступа по ролям

### 2. `order_editing.feature` - Редактирование заказов
Описывает функциональность редактирования существующих заказов:
- Изменение основных данных заказа
- Изменение клиента и услуги
- Добавление и удаление скидок
- Изменение времени услуги
- Отмена редактирования
- Валидация при редактировании

### 3. `order_payment.feature` - Управление оплатами
Описывает работу с оплатами заказов:
- Наличная и безналичная оплата
- Смешанные оплаты
- Автоматический расчет оплат
- Множественные оплаты к одному заказу
- Валидация сумм оплат
- Синхронизация даты оплаты с датой заказа
- Редактирование и удаление оплат

### 4. `order_calculation.feature` - Расчет сумм заказа
Описывает логику автоматического расчета сумм:
- Базовый расчет (цена × количество × коэффициент)
- Применение скидок разных типов
- Применение аванса
- Автоматический пересчет при изменении параметров
- Работа с дробными значениями
- Сохранение точности копеек

### 5. `order_filtering.feature` - Фильтрация и отображение
Описывает функциональность просмотра и фильтрации заказов:
- Фильтрация по дате
- Поиск по клиенту, услуге, времени
- Сортировка по различным полям
- Отображение колонок таблицы
- Переключение статуса оплаты
- Массовое удаление
- Работа без пагинации

### 6. `order_deletion.feature` - Удаление заказов
Описывает процесс удаления заказов:
- Удаление из списка и из формы редактирования
- Отмена удаления
- Удаление связанных данных (оплаты)
- Событие OrderDeleting
- Массовое удаление
- Права доступа на удаление
- Обновление кассового отчета

### 7. `order_permissions.feature` - Права доступа
Описывает систему прав доступа к заказам:
- Права супер-администратора
- Права администратора
- Права сотрудника
- Ограничения для разных ролей
- Видимость и доступность полей
- Фильтрация по правам

## Формат Gherkin

Все сценарии написаны на русском языке с использованием стандартного синтаксиса Gherkin:

```gherkin
# language: ru

Функция: Название функции
  Как <роль>
  Я хочу <действие>
  Чтобы <результат>

  Предыстория:
    Дано <начальное условие>

  Сценарий: Название сценария
    Когда <действие>
    Тогда <ожидаемый результат>
```

## Ключевые слова

- **Функция** (Feature) - описывает функциональность
- **Предыстория** (Background) - общие шаги для всех сценариев
- **Сценарий** (Scenario) - описывает конкретный тест-кейс
- **Дано** (Given) - начальное состояние
- **Когда** (When) - действие пользователя
- **Тогда** (Then) - ожидаемый результат
- **И** (And) - дополнительный шаг
- **Примеры** (Examples) - табличные данные для параметризованных тестов

## Использование

Эти сценарии можно использовать для:

1. **Документирования функциональности** - понятное описание всех возможностей OrderResource
2. **Написания автоматических тестов** - с помощью Behat, Cucumber или других BDD-фреймворков
3. **Коммуникации с командой** - единое понимание требований между разработчиками, тестировщиками и бизнесом
4. **Регрессионного тестирования** - проверка, что новые изменения не ломают существующую функциональность

## Покрытие функциональности

Сценарии покрывают следующие аспекты OrderResource:

- ✅ CRUD операции (создание, чтение, обновление, удаление)
- ✅ Валидация данных
- ✅ Бизнес-логика расчета сумм
- ✅ Управление оплатами
- ✅ Система прав доступа
- ✅ Фильтрация и поиск
- ✅ Интеграция с другими сущностями (клиенты, услуги, цены)
- ✅ События и слушатели
- ✅ Автоматические расчеты

## Количество сценариев

- **order_creation.feature**: 13 сценариев
- **order_editing.feature**: 11 сценариев
- **order_payment.feature**: 15 сценариев
- **order_calculation.feature**: 15 сценариев
- **order_filtering.feature**: 20 сценариев
- **order_deletion.feature**: 11 сценариев
- **order_permissions.feature**: 13 сценариев

**Всего: 98 сценариев**

## Примечания

- Все денежные суммы указаны в рублях
- Даты указаны в формате YYYY-MM-DD
- Время указано в формате HH:MM
- Сценарии предполагают использование часового пояса GMT+5 (Etc/GMT-5)
- Для некоторых сценариев требуется предварительная настройка тестовых данных
