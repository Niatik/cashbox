# language: ru

Функция: Редактирование заказа
  Как администратор системы
  Я хочу редактировать существующие заказы
  Чтобы вносить изменения в данные о заказах

  Предыстория:
    Дано я авторизован как супер-администратор
    И в системе существует услуга "Боулинг" стоимостью 5000 рублей
    И в системе существует клиент "Иванов Иван Иванович"
    И в системе существует источник "Instagram"
    И существует заказ:
      | дата          | 2024-01-15 |
      | время         | 14:00      |
      | услуга        | Боулинг    |
      | клиент        | Иванов Иван Иванович |
      | количество    | 2          |
      | источник      | Instagram  |
      | сумма         | 10000      |

  Сценарий: Успешное редактирование данных заказа
    Когда я открываю заказ для редактирования
    И изменяю количество человек на 3
    И сохраняю изменения
    Тогда я вижу сообщение "Заказ успешно обновлен"
    И количество человек в заказе равно 3
    И сумма заказа пересчитана на 15000 рублей

  Сценарий: Изменение клиента в заказе
    Дано в системе существует клиент "Петров Петр Петрович"
    Когда я открываю заказ для редактирования
    И выбираю клиента "Петров Петр Петрович"
    И сохраняю изменения
    Тогда я вижу сообщение "Заказ успешно обновлен"
    И заказ привязан к клиенту "Петров Петр Петрович"

  Сценарий: Добавление скидки к существующему заказу
    Когда я открываю заказ для редактирования
    И указываю скидку 1000 рублей
    И сохраняю изменения
    Тогда сумма к оплате составляет 9000 рублей
    И общая сумма заказа составляет 10000 рублей

  Сценарий: Изменение услуги в заказе
    Дано в системе существует услуга "Бильярд" стоимостью 3000 рублей
    Когда я открываю заказ для редактирования
    И выбираю услугу "Бильярд"
    И сохраняю изменения
    Тогда услуга заказа изменена на "Бильярд"
    И сумма заказа пересчитана согласно новой услуге

  Сценарий: Редактирование заказа сотрудником
    Дано я авторизован как сотрудник
    Когда я открываю заказ для редактирования
    Тогда поле "Дата заказа" скрыто для меня
    И я могу изменить количество человек
    И я могу изменить клиента
    Но я не могу изменить дату заказа

  Сценарий: Отмена редактирования заказа
    Когда я открываю заказ для редактирования
    И изменяю количество человек на 5
    И нажимаю "Отмена"
    Тогда я перехожу к списку заказов
    И количество человек в заказе остается равным 2

  Сценарий: Редактирование времени услуги
    Дано в системе существует время услуги "2 часа" с коэффициентом 2.0
    Когда я открываю заказ для редактирования
    И выбираю время услуги "2 часа"
    И сохраняю изменения
    Тогда сумма заказа пересчитана с учетом коэффициента 2.0
    И новая сумма заказа составляет 20000 рублей

  Сценарий: Удаление скидки из заказа
    Дано заказ имеет скидку 1000 рублей
    Когда я открываю заказ для редактирования
    И удаляю значение скидки
    И сохраняю изменения
    Тогда сумма к оплате составляет 10000 рублей
    И скидка не применяется к заказу

  Сценарий: Изменение источника заказа
    Дано в системе существует источник "VK"
    Когда я открываю заказ для редактирования
    И выбираю источник "VK"
    И сохраняю изменения
    Тогда источник заказа изменен на "VK"

  Сценарий: Валидация при редактировании - удаление обязательных полей
    Когда я открываю заказ для редактирования
    И очищаю поле "Услуга"
    И пытаюсь сохранить изменения
    Тогда я вижу ошибку "Поле 'Услuga' обязательно для заполнения"
    И изменения не сохраняются
